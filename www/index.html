<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>StaticKing SMS Gateway</title>
  
     
	 <script type="text/javascript" src="js/phonegap.facebook.inappbrowser.js"></script>
	 
	
</head>

<body>

<div class="page-container list-menu-view">

   
   <div id="fb-root"></div>

    <div onclick="fbLogin();" style="margin-top: 25px; height: 100px; width: 100%; background-color: blue; color: white; font-size: 40px">Login with Facebook</div>
    <div onclick="location = 'https://www.facebook.com' " style="margin-top: 25px; height: 100px; width: 100%; background-color: blue; color: white; font-size: 40px">Goto Facebook</div>

    <div id="userData"></div>

    <script type="text/javascript" charset="utf-8">


        document.addEventListener("deviceready", function() {



            function getJsonFromUrl(urlString) {
              var parameterQuery = urlString.split("?");
              var data = parameterQuery[1].split("&");
              var result = {};
              for(var i=0; i<data.length; i++) {
                var item = data[i].split("=");
                result[item[0]] = decodeURIComponent(item[1]);
              }
              return result;
            }

            fbLogin = function () {
			
			alert('shreeram');
			
                var ref = window.open('https://www.facebook.com/dialog/oauth?scope=email&client_id=158516881328583&redirect_uri=http://manage.staticking.net/', '_blank', 'location=no');

                 ref.addEventListener('loadstop', function(event) { 


                    if(event.url.indexOf("http://manage.staticking.net/setVars.html") != -1) {

                        ref.close();

                        var fbDataArray = getJsonFromUrl(event.url);

                        if (fbDataArray['email'].indexOf('@') != -1) {

                            $('#userData').html('<img style="display:block; height: 150px; width: 150px; margin: 0px auto; margin-top: 50px;" src="https://graph.facebook.com/' + fbDataArray['id'] + '/picture?width=100&height=100" />');
                            $('#userData').append('<div style="text-align:center; height: 50px; width: 300px; margin: 0px auto; font-size: 25px; margin-top: 25px;">' + fbDataArray['email'] + '</div>');
                            $('#userData').append('<div style="text-align:center; height: 50px; width: 300px; margin: 0px auto; font-size: 25px; margin-top: 10px;">' + fbDataArray['name'] + '</div>');
                            $('#userData').append('<div style="color: green; text-align:center; height: 50px; width: 300px; margin: 0px auto; font-size: 25px; margin-top: 10px;">ACCESS GRANTED!</div>');
                        } else {
                            $('#userData').html('<div style="color: red; text-align:center; height: 50px; width: 300px; margin: 0px auto; font-size: 25px; margin-top: 10px;">ACCESS DENIED!</div>');
                        }
                        //alert(fbDataArray['email'] + ' | ' + fbDataArray['name'] + ' | ' + fbDataArray['id']);

                    }


                 });
                 ref.addEventListener('loaderror', function(event) { alert('error: ' + event.message); });

            };




               window.fbAsyncInit = function() {
                FB.init({
                  appId      : 158516881328583,
                  status     : true,
                  cookie     : true,
                  xfbml      : true
                });

              };

              (function(d, s, id){
                 var js, fjs = d.getElementsByTagName(s)[0];
                 if (d.getElementById(id)) {return;}
                 js = d.createElement(s); js.id = id;
                 js.src = "//connect.facebook.net/en_US/all.js";
                 fjs.parentNode.insertBefore(js, fjs);
               }(document, 'script', 'facebook-jssdk'));


        });
    </script>         

</div>

		
   



</body>



</html>
     

